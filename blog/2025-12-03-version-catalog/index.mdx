---
slug: mts-version-catalog
title: 국내 MTS에 Version Catalog 도입하기
authors: [way]
tags: [android,toml,version-catalog,gradle,mts,한국투자증권,한투]
---

안녕하세요, [한국투자증권](https://securities.koreainvestment.com/main/Main.jsp)에서 [한투-한국투자증권](https://play.google.com/store/apps/details?id=com.truefriend.neosmartarenewal&hl=ko) 개발을 담당하고 있는 way입니다.<br/>

국내 MTS 프로젝트에 적용하게 된 Version Catalog에 대해 설명해드리겠습니다.<br/>
안드로이드는 gradle을 빌드 시스템으로 사용하며, groovy 또는 kotlin DSL을 통해 의존성 관리를 수행합니다.<br/>
기존 프로젝트에서는 여러 모듈에서 각기 다른 라이브러리 버전을 사용하고 있어, 우선 이들을 일관되게 관리하는 방법으로 [Version Catalog](https://developer.android.com/build/migrate-to-catalogs?hl=ko) 적용을 검토하게 되었습니다.<br/>

### 현재 프로젝트 구조

app에 지나치게 의존적이고 3rd party 라이브러리가 산재해 있어 유지보수가 어려운 상황이었습니다.<br/>
이를 해결하기 위해 Multi Module 구조로 전환하는 작업을 진행했고, 그 과정에서 Version Catalog를 도입하게 되었습니다.<br/>
대략적인 프로젝트 구조는 다음과 같습니다.

<div style={{textAlign: 'center', margin: '1.5rem 0'}}>
  <img src="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExZ25lcGU0OGlxYjJqZzhnaDl3NHd4OWt4aGk3MzRvanc0MTIxdDgzcyZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/iHe7mA9M9SsyQ/giphy.gif" alt="Success" style={{maxWidth: '100%', borderRadius: '8px', maxHeight: '250px'}} />
</div>

```text
.
├── app
├── 3rd_party_library_1
├── 3rd_party_library_2
├── 3rd_party_library_3
├── 3rd_party_library_4
└── formdeCore
```

### Version Catalog 도입하기

Gradle의 [Version Catalog](https://developer.android.com/build/migrate-to-catalogs?hl=ko)를 도입해 모듈 간 라이브러리 버전을 중앙에서 관리하도록 변경했습니다.<br/>
구체적으로는 `gradle/libs.versions.toml` 파일을 만들고, 각 모듈의 `build.gradle.kts`에서 해당 카탈로그를 참조하도록 했습니다.

#### versions
- 각 모듈의 라이브러리 버전을 정의합니다.
- 패키징되어있는 라이브러리들의 경우 버전이 동일한 경우가 많기 때문에 버전을 공통으로 관리하면 편리합니다.

#### libraries
- 각 모듈에서 사용할 라이브러리와 해당 버전을 정의합니다.

#### plugins
- 각 모듈에서 사용할 플러그인과 해당 버전을 정의합니다.

#### bundles
- 관련된 라이브러리들을 묶어서 한 번에 참조할 수 있도록 정의합니다.
- 필요한 라이브러리들을 패키징하여 한 번에 추가할 수 있어 편리합니다.

예시로 사용한 `libs.versions.toml`은 다음과 같습니다.

```toml
[versions]
kotlin = "2.0.21"
target-sdk = "36"
jvm = "17"
min-sdk = "26"
compile-sdk = "36"
android-gradle-plugin = "8.3.2"
.
.
.

[plugins]
android-application = { id = "com.android.application", version.ref = "android-gradle-plugin" }
.
.
.

[libraries]
android-gradle-plugin = { module = "com.android.tools.build:gradle", version.ref = "android-gradle-plugin" }
.
.
.
[bundles]
kotlin = ["kotlin-stdlib", "kotlin-reflect"]
```

그리고 각 모듈의 `build.gradle.kts`에서 다음과 같이 플러그인과 버전을 참조하도록 변경했습니다.

```kotlin
plugins {
    alias(libs.plugins.android.application)
    alias(libs.plugins.kotlin.android)
}

android {
    compileSdk = libs.versions.compile.sdk.get().toInt()

    defaultConfig {
        applicationId = "com.example.app"
        minSdk = libs.versions.min.sdk.get().toInt()
        targetSdk = libs.versions.target.sdk.get().toInt()
        versionCode = 1
        versionName = "1.0"
    }
    dependencies {
        implementation(libs.bundles.kotlin)
    }
}
```

### 마치며

이와 같이 Version Catalog를 적용하면, 라이브러리 버전 관리가 일관화되어 업데이트나 충돌 해결이 훨씬 수월해집니다.<br/>
또한, 새로운 라이브러리를 추가할 때도 중앙 파일만 수정하면 되므로 유지보수가 간편해집니다.

<div style={{textAlign: 'center', margin: '1.5rem 0'}}>
  <img src="https://media4.giphy.com/media/v1.Y2lkPTc5MGI3NjExbXlja2N5Z3Fva3F1cmJjZzA4N210aXM4NW5lODN4bGpiZTc3cWI1OCZlcD12MV9pbnRlcm5hbF9naWZfYnlfaWQmY3Q9Zw/Ala8Pjo4RN9kY/giphy.gif" alt="Success" style={{maxWidth: '100%', borderRadius: '8px', maxHeight: '250px'}} />
</div>